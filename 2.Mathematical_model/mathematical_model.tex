\section{Methodology and theory}
\label{sec:problem_description}

\subsection{计算机视觉-图像分割}

对于采集的到的图像数据，可以适当进行图像前处理。在保证图像的完整性和质量的前提下，可以对图像进行一定的处理，用以突出图像中我们希望让计算机识别的特征，并且在一定程度上去除图像的无关特征和噪声，以提高后续的深度学习模型的准确性。

图像分割是图像处理中的一个重要步骤，其目的是将图像分割成若干个具有独立意义的区域，以便进一步分析和处理。作为只关注生物组织完整度的模型，在这里需要将生物切片分割成生物组织和石蜡区域两个部分，然后对图像进行分割，突出显示生物组织部分的部分。

常见的图像分割算法有边缘检测,阈值分割等。

\subsubsection{边缘检测}
对于生物切片组织，一个判断其质量的重要指标是切片的边缘是否清晰。切片边缘的完整性和连续性能够很好的反应该样品是否存在质量问题。

关于边缘检测，有许多的算法，如sobel算子，laplacian算子、Canny算子等。https://ieeexplore.ieee.org/abstract/document/6240859

\textbf{sobel算子}是一种一阶微分算子，可用来检测图像边缘。（Learning OpenCV by Bradski and Kaehler.）假设有一个一维图像$f(x)$，其强度与像素坐标$x$之间的关系可以如图1表示。可以观察到在\autoref{fig:original_function}中，在x=2.2左右斜率最大，可见在此处附近图像强度存在突变（存在边缘）。对其求导得到一阶导数$f'(x)$，如\autoref{fig:first_derivative}所示，此时导数的绝对值最大。sobel算子就是利用这一特性来检测边缘的。

\begin{figure}[htbp]
    \centering
    \begin{minipage}[b]{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{./fig/original_function.png}
        \caption{f(x)}
        \label{fig:original_function}
    \end{minipage}
    \begin{minipage}[b]{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{./fig/first_derivative.png}
        \caption{f'(x)}
        \label{fig:first_derivative}
    \end{minipage}
    \begin{minipage}[b]{0.32\textwidth}
        \centering
        \includegraphics[width=\textwidth]{./fig/second_derivative.png}
        \caption{f''(x)}
        \label{fig:second_derivative}
    \end{minipage}
\end{figure}

\textbf{Laplacian算子}是一种二阶微分算子，其对图像的边缘检测效果较好。它是对sobel算子再进行一次求导得出。在2D图像中，Laplacian算子的定义如下：
\begin{equation}
    \nabla^2 f = \frac{\partial^2 f}{\partial x^2} + \frac{\partial^2 f}{\partial y^2}
\end{equation}
如上图所示，对一阶导数再次求导得到二阶导数$f''(x)$，如\autoref{fig:second_derivative}所示，可以看到在x=2.2左右，二阶导数为0，即说明当laplacian算子$\nabla^2 f$的值为0时，说明图像强度存在突变，即存在边缘。

\textbf{Canny算子}是一种多阶微分算子，他在sobel算子计算后的基础上加入了对噪声的抑制。他由John F. Canny于1986年提出。（https://ieeexplore.ieee.org/document/4767851/authors\#authors）简而言之，其在sobel算子计算后，通过非极大值抑制，滞后阈值等步骤，设置了阈值，排除图像中的假边缘，得到了更加准确的边缘检测结果。

在Experimental work/analytical investigation/ design这一章节中 将会对采集到的图像数据进行三种边缘检测算法的实验，对比其效果。

\subsubsection{阈值分割}

除了边缘检测，还有一种方法是阈值分割。阈值分割是将图像中的像素点分为两类，一类是大于阈值的像素点，另一类是小于阈值的像素点。这种方法适用于图像中的目标和背景的灰度差异较大的情况。

对于样品来说，一个很简单的方法就是将石蜡区域和生物组织区域（样品在制备是已染色）的颜色进行对比，然后通过阈值分割的方法将其分割开来。假定生物组织为黄色，石蜡为白色，那么可以通过设置一个阈值，将图像中的白色部分分割出来，那么剩下的就是生物组织部分。

此外，关于阈值分割还有更多的方法，比如下面就是一个基于Otsu方法的指纹提取算法。将其用在此处能够显著提高生物组织的分割效果。
Yue Yaru和Zhu Jialin 在 《Algorithm of fingerprint extraction and implementation based on OpenCV》一文中提出了一种基于OpenCV的指纹提取算法。该算法对Otsu方法进行了改进，特别是在光照不均匀、图像模糊的情况下能够实现准确、简单、运行时间短的指纹提取。
https://ieeexplore.ieee.org/document/7984539

相关的对比和实验将在 Experimental work/analytical investigation/ design这一章节中进行。

\subsection{深度学习}

\subsubsection{卷积神经网络}

卷积神经网络（CNN）是一种深度学习模型，尤其擅长处理图像数据。它通过一系列卷积层自动学习空间层次的特征，无需手动特征提取。一个典型的CNN模型包括卷积层、池化层、全连接层等。（https://iopscience.iop.org/article/10.1088/1755-1315/440/4/042055/meta）其架构如下所示。


\begin{tikzpicture}[
    node distance=1cm and 0.5cm,
    block/.style={rectangle, draw, text width=4em, text centered, minimum height=15mm, fill=blue!30},
    arrow/.style={->,>=stealth}
]

% Define nodes in a matrix
\matrix [column sep=10mm, row sep=10mm] {
  \node (n1) [block] {1 Input}; & \node (n2) [block] {2 Conv}; & \node (n3) [block] {3 Pool} ;& \node
  (n4) [block] {4 Conv};    & \node (n5) [block] {5 FC};   & \node (n6) [block] {6 Output}; \\
};

% Connect nodes
\draw [arrow] (n1) -- (n2);
\draw [arrow] (n2) -- (n3);
\draw [arrow] (n3) -- (n4);
\draw [arrow] (n4) -- (n5);
\draw [arrow] (n5) -- (n6);
\end{tikzpicture}

where Conv is convolutional layer，是cnn的核心层，用于提取图像的特征。Pool是池化层，用于减小特征图的尺寸，减少计算量。FC是全连接层，用于将卷积层和池化层提取的特征进行分类或回归分析，最后输出结果。

对于一个典型的训练cnn的方法，包括前向传播、损失计算、反向传播和权重更新的过程。
\begin{enumerate}
    \item 前向传播：输入数据通过网络的每一层，直到输出层。
    \item 计算损失：使用损失函数（如交叉熵损失）计算网络输出和实际标签之间的差异。
    \item 反向传播：计算损失函数关于网络权重的梯度。
    \item 权重更新：使用梯度下降算法或其变种（如Adam或RMSprop）来更新网络权重，目标是减少损失函数的值。
\end{enumerate}
训练完成后，CNN可以用来预测新的、未见过的图像的标签。CNN的特点就是在于能够自动、有效地学习空间层次结构的特征。

\subsubsection{迁移学习}

显然，对于复杂的图像来说，搭建简单的cnn网络明显不够。这时候就需要迁移学习。迁移学习是一种机器学习方法，通过将一个模型训练的知识迁移到另一个模型上，从而加速训练过程。迁移学习的核心思想是利用源领域的知识来帮助目标领域的学习。

对于cnn模型来说，迁移学习的方法有很多，比如微调、特征提取等。微调是指在一个预训练的模型上，通过调整网络的参数，使其适应新的任务。特征提取是指在一个预训练的模型上，固定网络的参数，只训练全连接层，以适应新的任务。

常用的已经训练好的模型有VGG、Inception等。这些模型在ImageNet等数据集上已经训练好，即模型内部各层的权重已经确定，可以用来进行迁移学习。

表2展示了VGG16，VGG19（https://arxiv.org/abs/1409.1556），InceptionV3，（https://arxiv.org/abs/1512.00567）Xception（https://arxiv.org/abs/1610.02357），等模型的参数数量。可以看到，这些模型的参数数量都很大，可以较为准确地提取复杂图像的特征。

\begin{table}[htbp]
    \centering
    \caption{Comparison of CNN Models}
    \label{tab:model_comparison}
    \begin{tabular}{ccccc}
        \toprule
        \textbf{Model} & \textbf{VGG16} & \textbf{VGG19} & \textbf{InceptionV3} & \textbf{Xception} \\
        \midrule
        \textbf{Number of Parameters} & 138,357,544 & 143,667,240 & 23,851,784 & 22,910,480 \\
        \bottomrule
    \end{tabular}
\end{table}


\FloatBarrier






